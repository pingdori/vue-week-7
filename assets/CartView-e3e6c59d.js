import{_ as m,o,c as d,a as h,b as t,F as _,f as g,g as b,t as l,n as C,h as f,v}from"./index-e1196c11.js";const{VITE_APP_URL:u,VITE_APP_PATH:c}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"pokebox",BASE_URL:"/vue-week-7/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},y={data(){return{products:[],productId:"",form:{user:{name:"",email:"",tel:"",address:""},message:""},cart:{},loadingItem:"",isLoading:!1}},methods:{deleteAllCarts(){const s=`${u}/api/${c}/carts`;this.$http.delete(s).then(a=>{alert(a.data.message),this.getCarts()}).catch(a=>{alert(a.response.data.message)})},getCarts(){this.$http.get(`${u}/v2/api/${c}/cart`).then(s=>{this.cart=s.data.data}).catch(s=>{alert(s.response.data.message)})},updateCartItem(s){const a={product_id:s.product.id,qty:s.qty};this.loadingItem=s.id,this.$http.put(`${u}/v2/api/${c}/cart/${s.id}`,{data:a}).then(i=>{this.getCarts(),this.loadingItem=""}).catch(i=>{alert(i.response.data.message)})},deleteItem(s){this.loadingItem=s.id,this.$http.delete(`${u}//v2/api/${c}/cart/${s.id}`).then(a=>{this.loadingItem="",this.getCarts()}).catch(a=>{alert(a.response.data.message)})},createOrder(){const s=`${u}/api/${c}/order`,a=this.form;this.$http.post(s,{data:a}).then(i=>{alert(i.data.message),this.$refs.form.resetForm(),this.getCarts()}).catch(i=>{alert(i.response.data.message)})}},mounted(){this.getCarts(),this.isLoading=!0,setTimeout(()=>{this.isLoading=!1},1e3)}},k={class:"table align-middle"},A={style:{width:"200px"}},$={key:0,class:"h5"},E={key:1,class:"h6"},I={class:"h5"},x={class:"btn-group btn-group-sm"},F=["onClick"],P=t("i",{class:"fas fa-spinner fa-pulse"},null,-1),V=["onClick"],T=t("i",{class:"fas fa-spinner fa-pulse"},null,-1),D={class:"text-end"},L={class:"table align-middle"},S=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",null,"單價")])],-1),U=["disabled","onClick"],w=t("i",{class:"fas fa-spinner fa-pulse"},null,-1),B={class:"input-group input-group-sm"},R=["onUpdate:modelValue","disabled","onChange"],q=["value"],M={class:"text-end"},N=t("td",{colspan:"3",class:"text-end"},"總計",-1),O={class:"text-end"},z=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),H={class:"text-end text-success"};function j(s,a,i,G,r,p){return o(),d(_,null,[h(" 這是購物車頁面 "),t("table",k,[t("tbody",null,[(o(!0),d(_,null,g(r.products,e=>(o(),d("tr",{key:e.id},[t("td",A,[t("div",{style:C([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${e.imageUrl})`}])},null,4)]),t("td",null,l(e.title),1),t("td",null,[e.price===e.origin_price?(o(),d("div",$,l(e.price)+" 元",1)):(o(),d("del",E,"原價 "+l(e.origin_price)+" 元",1)),t("div",I,"現在只要 "+l(e.price)+" 元",1)]),t("td",null,[t("div",x,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:n=>s.openModal(e.id)},[P,h(" 查看更多 ")],8,F),t("button",{type:"button",class:"btn btn-outline-danger",onClick:n=>s.addToCart(e.id)},[T,h(" 加到購物車 ")],8,V)])])]))),128))])]),t("div",D,[t("button",{class:"btn btn-outline-danger",type:"button",onClick:a[0]||(a[0]=e=>p.deleteAllCarts())},"清空購物車")]),t("table",L,[S,t("tbody",null,[r.cart.carts?(o(!0),d(_,{key:0},g(r.cart.carts,e=>(o(),d("tr",{key:e.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:e.id===r.loadingItem,onClick:n=>p.deleteItem(e)},[w,h(" x ")],8,U)]),t("td",null,l(e.product.title),1),t("td",null,[t("div",B,[f(t("select",{name:"",id:"",class:"form-control","onUpdate:modelValue":n=>e.qty=n,disabled:e.id===r.loadingItem,onChange:n=>p.updateCartItem(e)},[(o(),d(_,null,g(20,n=>t("option",{value:n,key:`${n}+1234`},l(n),9,q)),64))],40,R),[[v,e.qty]])])]),t("td",M,l(e.total),1)]))),128)):b("",!0)]),t("tfoot",null,[t("tr",null,[N,t("td",O,l(r.cart.total),1)]),t("tr",null,[z,t("td",H,l(r.cart.final_total),1)])])])],64)}const K=m(y,[["render",j]]);export{K as default};
